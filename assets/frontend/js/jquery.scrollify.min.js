/*!
 * jQuery Scrollify
 * Version 1.0.5
 *
 * Requires:
 * - jQuery 1.7 or higher
 *
 * https://github.com/lukehaas/Scrollify
 *
 * Copyright 2016, Luke Haas
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
 * the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
 * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
 * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(c){return b(c,a,a.document)}):"object"==typeof module&&module.exports?module.exports=function(c,d){return void 0===d&&(d="undefined"!=typeof window?require("jquery"):require("jquery")(c)),b(d,a,a.document),d}:b(jQuery,a,a.document)}("undefined"!=typeof window?window:this,function(a,b,c,d){"use strict";function D(c,d,h){if(j===c&&(h=!1),w===!0)return!0;if(f[c]){if(q=!1,h&&C.before(c,g),k=1,C.sectionName&&(z!==!0||0!==c))if(history.pushState)try{history.replaceState(null,null,f[c])}catch(a){b.console&&console.warn("Scrollify warning: This needs to be hosted on a server to manipulate the hash value.")}else b.location.hash=f[c];if(d)a(C.target).stop().scrollTop(e[c]),h&&C.after(c,g);else{if(r=!0,a().velocity?a(C.target).stop().velocity("scroll",{duration:C.scrollSpeed,easing:C.easing,offset:e[c],mobileHA:!1}):a(C.target).stop().animate({scrollTop:e[c]},C.scrollSpeed,C.easing),b.location.hash.length&&C.sectionName&&b.console)try{a(b.location.hash).length&&console.warn("Scrollify warning: There are IDs on the page that match the hash value - this will cause the page to anchor.")}catch(a){console.warn("Scrollify warning:",b.location.hash,"is not a valid jQuery expression.")}a(C.target).promise().done(function(){j=c,r=!1,z=!1,h&&C.after(c,g)})}}}function E(a){function b(b){for(var c=0,d=a.slice(Math.max(a.length-b,1)),e=0;e<d.length;e++)c+=d[e];return Math.ceil(c/b)}var c=b(10),d=b(70);return c>=d}function F(a,b){for(var c=f.length;c>=0;c--)"string"==typeof a?f[c]===a&&(i=c,D(c,b,!0)):c===a&&(i=c,D(c,b,!0))}var m,n,t,u,v,e=[],f=[],g=[],h=[],i=0,j=0,k=1,l=!1,o=a(b),p=o.scrollTop(),q=!1,r=!1,s=!1,w=!1,x=[],y=(new Date).getTime(),z=!0,A=!1,B="onwheel"in c?"wheel":c.onmousewheel!==d?"mousewheel":"DOMMouseScroll",C={section:".section",sectionName:"section-name",interstitialSection:"",easing:"easeOutExpo",scrollSpeed:1100,offset:0,scrollbars:!0,target:"html,body",standardScrollElements:!1,setHeights:!0,overflowScroll:!0,before:function(){},after:function(){},afterResize:function(){},afterRender:function(){}};a.scrollify=function(d){function j(b){a().velocity?a(C.target).stop().velocity("scroll",{duration:C.scrollSpeed,easing:C.easing,offset:b,mobileHA:!1}):a(C.target).stop().animate({scrollTop:b},C.scrollSpeed,C.easing)}function z(){var b=C.section;h=[],C.interstitialSection.length&&(b+=","+C.interstitialSection),a(b).each(function(b){var c=a(this);C.setHeights?c.is(C.interstitialSection)?h[b]=!1:c.css("height","auto").outerHeight()<o.height()||"hidden"===c.css("overflow")?(c.css({height:o.height()}),h[b]=!1):(c.css({height:c.height()}),C.overflowScroll?h[b]=!0:h[b]=!1):c.outerHeight()<o.height()||C.overflowScroll===!1?h[b]=!1:h[b]=!0})}function F(c){var d=C.section;C.interstitialSection.length&&(d+=","+C.interstitialSection),e=[],f=[],g=[],a(d).each(function(c){var h=a(this);c>0?e[c]=parseInt(h.offset().top)+C.offset:e[c]=parseInt(h.offset().top),C.sectionName&&h.data(C.sectionName)?f[c]="#"+h.data(C.sectionName).replace(/ /g,"-"):h.is(C.interstitialSection)===!1?f[c]="#"+(c+1):(f[c]="#",c===a(d).length-1&&c>1&&(e[c]=e[c-1]+parseInt(h.height()))),g[c]=h;try{a(f[c]).length&&b.console&&console.warn("Scrollify warning: Section names can't match IDs on the page - this will cause the browser to anchor.")}catch(a){}b.location.hash===f[c]&&(i=c,l=!0)}),!0===c?D(i,!1,!1):C.afterRender()}function G(){return!h[i]||(p=o.scrollTop(),!(p>parseInt(e[i])))}function H(){return!h[i]||(p=o.scrollTop(),!(p<parseInt(e[i])+(g[i].outerHeight()-o.height())-28))}A=!0,a.easing.easeOutExpo=function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},t={handleMousedown:function(){return w===!0||(q=!1,void(s=!1))},handleMouseup:function(){return w===!0||(q=!0,void(s&&t.calculateNearest(!1,!0)))},handleScroll:function(){return w===!0||(m&&clearTimeout(m),void(m=setTimeout(function(){return s=!0,q!==!1&&(q=!1,void t.calculateNearest(!1,!0))},200)))},calculateNearest:function(a,b){p=o.scrollTop();for(var h,c=1,d=e.length,f=0,g=Math.abs(e[0]-p);c<d;c++)h=Math.abs(e[c]-p),h<g&&(g=h,f=c);(H()||G())&&(i=f,D(f,a,b))},wheelHandler:function(c){if(w===!0)return!0;if(C.standardScrollElements&&(a(c.target).is(C.standardScrollElements)||a(c.target).closest(C.standardScrollElements).length))return!0;h[i]||c.preventDefault();var d=(new Date).getTime();c=c||b.event;var f=c.originalEvent.wheelDelta||-c.originalEvent.deltaY||-c.originalEvent.detail,g=Math.max(-1,Math.min(1,f));if(x.length>149&&x.shift(),x.push(Math.abs(f)),d-y>200&&(x=[]),y=d,r)return!1;if(g<0){if(i<e.length-1&&H()){if(!E(x))return!1;c.preventDefault(),i++,r=!0,D(i,!1,!0)}}else if(g>0&&i>0&&G()){if(!E(x))return!1;c.preventDefault(),i--,r=!0,D(i,!1,!0)}},keyHandler:function(a){return w===!0||r!==!0&&void(38==a.keyCode?i>0&&G()&&(a.preventDefault(),i--,D(i,!1,!0)):40==a.keyCode&&i<e.length-1&&H()&&(a.preventDefault(),i++,D(i,!1,!0)))},init:function(){C.scrollbars?(o.on("mousedown",t.handleMousedown),o.on("mouseup",t.handleMouseup),o.on("scroll",t.handleScroll)):a("body").css({overflow:"hidden"}),o.on(B,t.wheelHandler),o.on("keydown",t.keyHandler)}},u={touches:{touchstart:{y:-1,x:-1},touchmove:{y:-1,x:-1},touchend:!1,direction:"undetermined"},options:{distance:30,timeGap:800,timeStamp:(new Date).getTime()},touchHandler:function(b){if(w===!0)return!0;if(C.standardScrollElements&&(a(b.target).is(C.standardScrollElements)||a(b.target).closest(C.standardScrollElements).length))return!0;var c;if("undefined"!=typeof b&&"undefined"!=typeof b.touches)switch(c=b.touches[0],b.type){case"touchstart":u.touches.touchstart.y=c.pageY,u.touches.touchmove.y=-1,u.touches.touchstart.x=c.pageX,u.touches.touchmove.x=-1,u.options.timeStamp=(new Date).getTime(),u.touches.touchend=!1;case"touchmove":u.touches.touchmove.y=c.pageY,u.touches.touchmove.x=c.pageX,u.touches.touchstart.y!==u.touches.touchmove.y&&Math.abs(u.touches.touchstart.y-u.touches.touchmove.y)>Math.abs(u.touches.touchstart.x-u.touches.touchmove.x)&&(b.preventDefault(),u.touches.direction="y",u.options.timeStamp+u.options.timeGap<(new Date).getTime()&&0==u.touches.touchend&&(u.touches.touchend=!0,u.touches.touchstart.y>-1&&Math.abs(u.touches.touchmove.y-u.touches.touchstart.y)>u.options.distance&&(u.touches.touchstart.y<u.touches.touchmove.y?u.up():u.down())));break;case"touchend":u.touches[b.type]===!1&&(u.touches[b.type]=!0,u.touches.touchstart.y>-1&&u.touches.touchmove.y>-1&&"y"===u.touches.direction&&(Math.abs(u.touches.touchmove.y-u.touches.touchstart.y)>u.options.distance&&(u.touches.touchstart.y<u.touches.touchmove.y?u.up():u.down()),u.touches.touchstart.y=-1,u.touches.touchstart.x=-1,u.touches.direction="undetermined"))}},down:function(){i<=e.length-1&&(H()&&i<e.length-1?(i++,D(i,!1,!0)):Math.floor(g[i].height()/o.height())>k?(j(parseInt(e[i])+o.height()*k),k+=1):j(parseInt(e[i])+(g[i].height()-o.height())))},up:function(){i>=0&&(G()&&i>0?(i--,D(i,!1,!0)):k>2?(k-=1,j(parseInt(e[i])+o.height()*k)):(k=1,j(parseInt(e[i]))))},init:function(){c.addEventListener&&(c.addEventListener("touchstart",u.touchHandler,!1),c.addEventListener("touchmove",u.touchHandler,!1),c.addEventListener("touchend",u.touchHandler,!1))}},v={refresh:function(a){clearTimeout(n),n=setTimeout(function(){z(),F(!0),a&&C.afterResize()},400)},handleUpdate:function(){v.refresh(!1)},handleResize:function(){v.refresh(!0)}},C=a.extend(C,d),z(),F(!1),!0===l?D(i,!1,!0):setTimeout(function(){t.calculateNearest(!0,!1)},200),e.length&&(t.init(),u.init(),o.on("resize",v.handleResize),c.addEventListener&&b.addEventListener("orientationchange",v.handleResize,!1))},a.scrollify.move=function(b){return b!==d&&(b.originalEvent&&(b=a(this).attr("href")),void F(b,!1))},a.scrollify.instantMove=function(a){return a!==d&&void F(a,!0)},a.scrollify.next=function(){i<f.length&&(i+=1,D(i,!1,!0))},a.scrollify.previous=function(){i>0&&(i-=1,D(i,!1,!0))},a.scrollify.instantNext=function(){i<f.length&&(i+=1,D(i,!0,!0))},a.scrollify.instantPrevious=function(){i>0&&(i-=1,D(i,!0,!0))},a.scrollify.destroy=function(){return!!A&&(C.setHeights&&a(C.section).each(function(){a(this).css("height","auto")}),o.off("resize",v.handleResize),C.scrollbars&&(o.off("mousedown",t.handleMousedown),o.off("mouseup",t.handleMouseup),o.off("scroll",t.handleScroll)),o.off(B,t.wheelHandler),o.off("keydown",t.keyHandler),c.addEventListener&&(c.removeEventListener("touchstart",u.touchHandler,!1),c.removeEventListener("touchmove",u.touchHandler,!1),c.removeEventListener("touchend",u.touchHandler,!1)),e=[],f=[],g=[],void(h=[]))},a.scrollify.update=function(){return!!A&&void v.handleUpdate()},a.scrollify.current=function(){return g[i]},a.scrollify.disable=function(){w=!0},a.scrollify.enable=function(){w=!1,A&&t.calculateNearest(!1,!1)},a.scrollify.isDisabled=function(){return w},a.scrollify.setOptions=function(c){return!!A&&void("object"==typeof c?(C=a.extend(C,c),v.handleUpdate()):b.console&&console.warn("Scrollify warning: Options need to be in an object."))}});
